---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
    message = F, 
    warning = F,
    collapse = TRUE,
    comment = "#>",
    fig.path = "README-"
)
```

```{r, echo=FALSE}
library(tidyquant)
library(sweep)
```


# sweep

> A "tidy" toolkit for forecasting and time series analysis

The `sweep` package combines a set of tools for performing forecasts and time series analysis in the "tidyverse". While the package is geared towards the workflow required to perform forecasts using Rob Hyndman's `forecast` package, it contains elements that can help when performing time series analysis using tibbles ("tidy" data frames). 

## Benefits

* __Designed for modeling and scaling forecast analyses using the the `tidyverse` tools in [_R for Data Science_](http://r4ds.had.co.nz/)__
* __Extends `broom` for forecast model analysis__
* __Combined with the `forecast` and `tidyquant` packages enables end-to-end time series analysis capability__
* __Eliminates time series coercion issues between time-based tibbles ("tidy" data frames) and the major time series data types `xts`, `zoo`, `zooreg`, and `ts`__


## Tools

The package contains four primary elements:

1. __coercion functions__: `sw_tbl`, `sw_ts`, `sw_xts`, `sw_zoo`, and `sw_zooreg`. These functions coerce time-based tibbles `tbl` to and from each of the main time-series data types `xts`, `zoo`, `zooreg`, `ts`, maintaining the time-based index.

2. __broom model tidiers__: `sw_tidy`, `sw_glance`, `sw_augment`, `sw_tidy_decomp`. These functions extend `tidy`, `glance`, and `augment` from the `broom` package specifically for models (`ets()`, `Arima()`, `bats()`, etc) used for forecasting.

3. __forecast tidier__: `sw_sweep` converts a `forecast` to a tibble that can be easily manipulated in the "tidyverse".

4. __enhanced mapping functions__: `map_list_column` enables applying functions to lists for quickly creating complex nested data frames. 

## Making forecasts in the tidyverse

`sweep` enables transitioning from tibble to ts, from ts to model (e.g. Arima, ets, etc), from model to forecast, and then from forecast to tibble. The result is ability to use `dplyr`, `tidyr`, and `ggplot` natively to manipulate, analyze and visualize forecasts.

```{r echo=FALSE, out.width='100%'}
knitr::include_graphics("img/forecast.png")
```

## Forecasting multiple time series groups at scale

Often forecasts are required on grouped data to analyse trends in sub-categories. The good news is scaling from one time series to many is easy with the various `sw_` functions and the enhanced mapping function `map_list_column`.

```{r echo=FALSE, out.width='100%'}
knitr::include_graphics("img/time_series_groups.png")
```

## Forecasting multiple models for accuracy

TODO

## broom extensions for forecasting

If you are familiar with `broom`, you know how useful it is for retrieving "tidy" format model coefficients (`tidy`), accuracy statistics (`glance`), and residuals (`augment`). The `sweep` package extends these functions to forecast modeling functions such as ARIMA, ETS, BATS, TBATS, NNETAR, and more: just use the `sweep` functions, `sw_tidy`, `sw_glance`, and `sw_augment`. In addition, a new tidier, `sw_tidy_decomp` is designed to specifically tidy models that produce seasonal decompositions. The compatibility chart is listed below.

```{r, echo = F}
tibble::tribble(
    ~Function,       ~`sw_tidy()`, ~`sw_glance()`, ~`sw_augment()`, ~`sw_tidy_decomp()`,
    "ar()",          "",  "",  "", "",
    "arima()",       "X", "X", "X", "",
    "Arima()",       "X", "X", "X", "",
    "ets()",         "X", "X", "X", "X",
    "baggedETS()",   "",  "",  "",  "",
    "bats()",        "X", "X", "X", "X",
    "tbats()",       "X", "X", "X", "X",
    "nnetar()",      "X", "X", "X", "",
    "stl()",         "",  "",  "",  "X",
    "HoltWinters()", "X", "X", "X", "X",
    "StructTS",      "X", "X", "X", "X",
    "tslm()",        "X", "X", "X", "",
    "decompose()",   "",  "",  "",  "X",
    "adf.test()",    "X", "X", "",  "",
    "Box.test()",    "X", "X", "",  "",
    "kpss.test()",   "X", "X", "",  ""
) %>%
    knitr::kable(caption = "Function Compatibility: sw_tidy, sw_glance, sw_augment, sw_tidy_decomp",
                 align = c("l", "c", "c", "c", "c"))
```

This just scratches the surface of `sweep`. Here's how to install to get started.

## Installation

Development Version with Latest Features:

``` {r, eval = FALSE}
# install.packages("devtools")
devtools::install_github("business-science/sweep")
```

<!-- CRAN Approved Version: -->

<!-- ```{r, eval = FALSE} -->
<!-- install.packages("sweep") -->
<!-- ``` -->



## Further Information

The `sweep` package includes several vignettes to help users get up to speed quickly:

* SW00 - Introduction to `sweep`
* SW01 - Forecasting Time Series Groups in the tidyverse
* SW02 - TODO

<!-- See the [`tidyquant` vignettes](https://cran.r-project.org/package=tidyquant) for further details on the package. -->
